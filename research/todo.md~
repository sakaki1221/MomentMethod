#TODO
* y=y0判定は元のアルゴリズムの方がいいかもしれない．y0がどのように変動するかわからないから